(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],[,,,,,,,,,,function(e,t,a){e.exports=a(18)},,,,,function(e,t,a){},function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(9),r=a.n(s),l=(a(15),a(1)),o=a(6),c=a(3),d=a(2),u=a(5),m=a(4),h=(a(16),a(17),[]);h.blank="gray",h.active="blue",h.pipe_U_large="linear-gradient(to right, gray 5%,darkred 5%,darkred 95%, gray 95%)",h.pipe_D_large="linear-gradient(to right, gray 5%,darkred 5%, darkred 95%, gray 95%)",h.pipe_L_large="linear-gradient(to bottom, gray 5%,darkred 5%, darkred 95%, gray 95%)",h.pipe_R_large="linear-gradient(to bottom, gray 5%,darkred 5%, darkred 95%, gray 95%)",h.pipe_U_medium="linear-gradient(to right, gray 20%,darkred 20%, darkred 80%, gray 80%)",h.pipe_D_medium="linear-gradient(to right, gray 20%,darkred 20%, darkred 80%, gray 80%)",h.pipe_L_medium="linear-gradient(to bottom, gray 20%,darkred 20%, darkred 80%, gray 80%)",h.pipe_R_medium="linear-gradient(to bottom, gray 20%,darkred 20%, darkred 80%, gray 80%)",h.pipe_U_small="linear-gradient(to right, gray 33%,darkred 33%, darkred 67%, gray 67%)",h.pipe_D_small="linear-gradient(to right, gray 33%,darkred 33%, darkred 67%, gray 67%)",h.pipe_L_small="linear-gradient(to bottom, gray 33%,darkred 33%, darkred 67%, gray 67%)",h.pipe_R_small="linear-gradient(to bottom, gray 33%,darkred 33%, darkred 67%, gray 67%)",h.split="black",h.wall="white",h.tap="green",h.tap_active="yellow";var g=h,p=a(7),v="wss://secure-garden-92806.herokuapp.com/ws/sim",k=function(){function e(){Object(c.a)(this,e),this.callbacks={},this.socketRef=null}return Object(d.a)(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),Object(d.a)(e,[{key:"connect",value:function(){var e=this,t=v;this.socketRef=new WebSocket(t),this.socketRef.onmessage=function(t){console.log("Received"),e.socketNewMessage(t.data)},this.socketRef.onopen=function(){console.log("WebSocket open")},this.socketRef.onerror=function(e){console.log(e.message)},this.socketRef.onclose=function(){console.log("WebSocket closed, restarting.."),e.connect()}}},{key:"socketNewMessage",value:function(e){var t=JSON.parse(e),a=t.command;0!==Object.keys(this.callbacks).length&&("game"===a&&(console.log("game received"),this.callbacks[a](t)),"new_message"===a&&(console.log("okay so this was called"),this.callbacks[a](t.message)))}},{key:"initUser",value:function(e,t,a){console.log(t),this.sendMessage({command:"init",game_id:e,budget:t,grid_size:a})}},{key:"reset",value:function(e){this.sendMessage({command:"reset",game_id:e})}},{key:"blockClick",value:function(e,t,a){this.sendMessage({command:"block_click",game_id:e,i:t,j:a})}},{key:"directionClick",value:function(e,t,a){this.sendMessage({command:"direction_click",game_id:e,direction:t,pipe_size:a})}},{key:"changeSize",value:function(e,t,a,n){this.sendMessage({command:"change_size",game_id:e,i:t,j:a,pipe_size:n})}},{key:"deletePipe",value:function(e,t,a){this.sendMessage({command:"delete_pipe",game_id:e,i:t,j:a})}},{key:"changePressure",value:function(e,t){this.sendMessage({command:"change_init_pressure",game_id:e,initial_pressure:t})}},{key:"pipe_click",value:function(e,t,a){this.sendMessage({command:"pipe_click",game_id:e,i:t,j:a})}},{key:"addCallbacks",value:function(e){this.callbacks.game=e}},{key:"sendMessage",value:function(e){try{console.log("tried"),console.log(Object(p.a)({},e)),this.socketRef.send(JSON.stringify(Object(p.a)({},e)))}catch(t){console.log(t.message)}}},{key:"state",value:function(){return this.socketRef.readyState}},{key:"waitForSocketConnection",value:function(e){var t=this.socketRef,a=this.waitForSocketConnection;setTimeout((function(){if(1===t.readyState)return console.log("Connection is made"),void(null!=e&&e());console.log("Wait for connection.."),a(e)}),1)}}]),e}();k.instance=null;var b=k.getInstance(),f=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).gameIdChangeHandler=function(e){n.setState({game_id:e.target.value})},n.budgetChangeHandler=function(e){n.setState({budget:e.target.value})},n.sizeChangeHandler=function(e){n.setState({grid_size:e.target.value})},n.state={game_id:"",budget:"",grid_size:"mid"},n}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"login"},i.a.createElement("div",{className:"login-title"},i.a.createElement("p",null,"PlumbingSim")),i.a.createElement("div",{className:"login-form"},i.a.createElement("form",{onSubmit:function(t){return e.props.handleLogin(t,e.state.game_id,e.state.budget,e.state.grid_size)}},i.a.createElement("div",{className:"login-comp"},"Simulation ID",i.a.createElement("br",null),i.a.createElement("div",{className:"login-inputbox"},i.a.createElement("input",{type:"text",onChange:this.gameIdChangeHandler,value:this.state.game_id,placeholder:"Simulation Id",required:!0,className:"login-input"}))),i.a.createElement("div",{className:"login-comp"},"Budget ",i.a.createElement("br",null),i.a.createElement("div",{className:"login-inputbox"},i.a.createElement("input",{type:"number",onChange:this.budgetChangeHandler,value:this.state.budget,min:"0",step:"1",placeholder:"Budget",required:!0,className:"login-input"}))),i.a.createElement("div",{className:"login-comp"},"Grid:",i.a.createElement("br",null),i.a.createElement("div",{className:"size-options"},i.a.createElement("input",{type:"radio",checked:"large"==this.state.grid_size,value:"large",onChange:this.sizeChangeHandler}),"Large"),i.a.createElement("div",{className:"size-options"},i.a.createElement("input",{type:"radio",checked:"mid"==this.state.grid_size,value:"mid",onChange:this.sizeChangeHandler}),"Medium"),i.a.createElement("div",{className:"size-options"},i.a.createElement("input",{type:"radio",checked:"small"==this.state.grid_size,value:"small",onChange:this.sizeChangeHandler}),"Small"),i.a.createElement("div",{className:"size-options"},i.a.createElement("input",{type:"radio",checked:"sub_opt"==this.state.grid_size,value:"sub_opt",onChange:this.sizeChangeHandler}),"Sub Optimal Model")),i.a.createElement("div",{className:"login-submit"},i.a.createElement("button",Object(o.a)({className:"submit",type:"submit"},"className","login-submit-button"),"Start")))),i.a.createElement("div",{className:"log"},i.a.createElement("a",{href:"/sim/log"},"View Logs")))}}]),a}(i.a.Component),y=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"square",style:{background:this.props.color,height:this.props.dimenh,width:this.props.dimenw,fontSize:this.props.fontsize},onClick:this.props.onClick},this.props.pressure)}}]),a}(i.a.Component),C=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).handleContextMenu=function(t,a,n){e.props.handleContextMenu(t,a,n)},e}return Object(d.a)(a,[{key:"renderBlock",value:function(e,t){var a=this,n=g[this.props.grid[e][t]],s=this.props.pressure[e][t];return i.a.createElement(y,{x:e,y:t,color:n,onClick:function(n){return a.props.onClick(n,e,t)},onContextMenu:function(n){return a.handleContextMenu(n,e,t)},pressure:s,dimen:this.props.dimen,dimenh:this.props.dimenh,dimenw:this.props.dimenw,fontsize:this.props.fontsize})}},{key:"renderRow",value:function(e,t){for(var a=[],n=0;n<t;n++)a.push(this.renderBlock(e,n));return a}},{key:"renderGrid",value:function(e,t){for(var a=[],n=0;n<e;n++)a.push(this.renderRow(n,t));return a}},{key:"render",value:function(){var e=this.props.height,t=this.props.width,a="50vw";return e!=t&&(a="75vw"),i.a.createElement("div",{className:"gridx",style:{width:a}},this.renderGrid(e,t))}}]),a}(i.a.Component);function E(e){return i.a.createElement("button",{className:"direction",onClick:e.onClick})}function _(e){return i.a.createElement("button",{className:"blank"})}var N=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"renderDirection",value:function(e){var t=this;return i.a.createElement(E,{text:e,onClick:function(){return t.props.onClick(e)}})}},{key:"renderBlank",value:function(){return i.a.createElement(_,null)}},{key:"render",value:function(){return i.a.createElement("div",{className:"controls"},i.a.createElement("div",{className:"controls-lhs"},i.a.createElement("p",null,"Pipe Direction")),i.a.createElement("div",{className:"controls-rhs"},i.a.createElement("div",{className:"gridc"},this.renderBlank(),this.renderDirection("Up"),this.renderBlank(),this.renderDirection("Left"),this.renderBlank(),this.renderDirection("Right"),this.renderBlank(),this.renderDirection("Down"),this.renderBlank())))}}]),a}(i.a.Component);function O(e){return i.a.createElement("div",{className:"resetdiv"},i.a.createElement("div",{className:"resetdiv-lhs"},"Reset"),i.a.createElement("div",{className:"resetdiv-rhs"},i.a.createElement("button",{className:"submit1",onClick:e.onClick},"Reset")))}var w=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleChange=function(e){n.setState({selectedOption:e.target.value}),n.props.handleOptionChange(e)},n.state={selectedOption:"large"},n}return Object(d.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"size"},i.a.createElement("div",{className:"size-lhs"},"Pipe Size"),i.a.createElement("div",{className:"size-rhs"},i.a.createElement("div",{className:"inputdiv"},i.a.createElement("label",{for:"small"},i.a.createElement("input",{id:"small",type:"radio",value:"small",checked:"small"==this.state.selectedOption,onChange:this.handleChange}),"0.5 inch")),i.a.createElement("div",{className:"inputdiv"},i.a.createElement("label",{for:"medium"},i.a.createElement("input",{id:"medium",type:"radio",value:"medium",checked:"medium"==this.state.selectedOption,onChange:this.handleChange}),"0.75 inch")),i.a.createElement("div",{className:"inputdiv"},i.a.createElement("label",{for:"large"},i.a.createElement("input",{id:"large",type:"radio",value:"large",checked:"large"==this.state.selectedOption,onChange:this.handleChange}),"1 inch"))))}}]),a}(i.a.Component),S=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={initial_pressure:""},n.handleChange=n.handleChange.bind(Object(l.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(l.a)(n)),n}return Object(d.a)(a,[{key:"handleChange",value:function(e){this.setState({initial_pressure:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this.state.initial_pressure;this.setState({initial_pressure:""}),this.props.handlePressureChange(e,t)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"init-pressure"},i.a.createElement("div",{className:"init-pressure-lhs"},"Change Initial Pressure"),i.a.createElement("div",{className:"init-pressure-rhs"},i.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},i.a.createElement("div",{className:"pdisplay"},i.a.createElement("input",{type:"text",onChange:this.handleChange,className:"pressure-input",value:this.state.initial_pressure}),i.a.createElement("button",{className:"submit",type:"submit"},"Apply")))))}}]),a}(i.a.Component),j=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).handleLogin=function(e,t,a,i){e.preventDefault(),n.setState({game_id:t,budget:a}),console.log(a),b.connect(),n.waitForSocketConnection((function(){b.initUser(t,a,i),b.addCallbacks(n.gameUpdate.bind(Object(l.a)(n)))}))},n.handleOptionChange=function(e){console.log(e.target.value),n.setState({pipe_size:e.target.value})},n.setVisibility=function(){n.setState({visible:!1}),document.removeEventListener("click",n.setVisibility)},n.handleContextMenu=n.handleContextMenu.bind(Object(l.a)(n)),n.handleSizeChange=n.handleSizeChange.bind(Object(l.a)(n)),n.handleDeletePipe=n.handleDeletePipe.bind(Object(l.a)(n)),n.handlePressureChange=n.handlePressureChange.bind(Object(l.a)(n)),n.handleBlockClick=n.handleBlockClick.bind(Object(l.a)(n)),n.setVisibility=n.setVisibility.bind(Object(l.a)(n));var i=[],s=[],r=(100/22).toString()+"%",o=100/22,d=(100/22).toString()+"%",u=o.toString()+"%";console.log(r);for(var m=0;m<22;m++){var h=Array(22).fill("blank"),g=Array(22).fill("");s.push(g),i.push(h)}return s[21][0]="60",i[21][0]="active",n.state={size:22,grid:i,row:21,col:0,game_id:"",loggedIn:!1,pipe_size:"large",menuX:"100px",menuY:"100px",visible:!1,currBlockX:0,currBlockY:0,pressure:s,initial_pressure:"60",cost:0,budget:0,dimenw:d,dimenh:u,fontsize:0,height:22,width:22},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"waitForSocketConnection",value:function(e){var t=this;setTimeout((function(){if(1===b.state())return console.log("Connection is made"),void e();console.log("Waiting for connection.."),t.waitForSocketConnection(e)}),100)}},{key:"handleDirectionClick",value:function(e){var t=this.state.game_id,a=this.state.pipe_size;b.directionClick(t,e,a)}},{key:"handleBlockClick",value:function(e,t,a){var n=this.state.game_id,i=this.state.grid;"split"==i[t][a]||"tap"==i[t][a]?b.blockClick(n,t,a):"pipe"==i[t][a].split("_")[0]&&this.handleContextMenu(e,t,a)}},{key:"handleReset",value:function(){console.log("reset"),b.reset(this.state.game_id)}},{key:"gameUpdate",value:function(e){console.log("update");var t=e.grid,a=e.row,n=e.col,i=e.size,s=e.pressure,r=e.initial_pressure,l=e.cost,o=e.budget,c=e.height,d=e.width,u=(100/i).toString()+"%",m=100/c,h=100/d,g=m.toString()+"%",p=h.toString()+"%",v=(13==i?3:22==i?2:1.4).toString()+"vw";this.setState({loggedIn:!0,grid:t,row:a,col:n,pressure:s,initial_pressure:r,cost:l,budget:o,size:i,height:c,width:d,dimen:u,dimenh:g,dimenw:p,fontsize:v}),console.log(c,m,g),console.log(d,h,p)}},{key:"handleContextMenu",value:function(e,t,a){if("pipe"==this.state.grid[t][a].split("_")[0]){var n=this.state.game_id;b.pipe_click(n,t,a),e.preventDefault(),console.log(e.clientX,e.clientY),console.log(t,a),this.setState({menuX:e.clientX,menuY:e.clientY,visible:!0,currBlockX:t,currBlockY:a});document.addEventListener("click",this.setVisibility)}}},{key:"handleDeletePipe",value:function(e){var t=this.state.game_id,a=this.state.currBlockX,n=this.state.currBlockY;b.deletePipe(t,a,n)}},{key:"handleSizeChange",value:function(e){var t=e.target.value,a=this.state.game_id,n=this.state.currBlockX,i=this.state.currBlockY;b.changeSize(a,n,i,t)}},{key:"handlePressureChange",value:function(e,t){e.preventDefault();var a=this.state.game_id,n=+t;Number.isInteger(n)&&n>0?b.changePressure(a,n):alert("Enter a positive integer")}},{key:"render",value:function(){var e=this,t=this.state.size,a=this.state.height,n=this.state.width,s=this.state.grid,r=this.state.loggedIn,l=this.state.pressure,o=this.state.cost,c=this.state.budget,d=c>=o?"green":"red",u=this.state.dimen,m=this.state.dimenh,h=this.state.dimenw,g=this.state.fontsize,p="75vw";return a!=n&&(p="100vw"),r?i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"rowC ",style:{width:p}},i.a.createElement(C,{size:t,height:a,width:n,grid:s,onClick:function(t,a,n){return e.handleBlockClick(t,a,n)},handleContextMenu:this.handleContextMenu,pressure:l,dimen:u,dimenh:m,dimenw:h,fontsize:g}),i.a.createElement("div",{className:"lhs"},i.a.createElement("div",{className:"budget"},i.a.createElement("div",{className:"budget-lhs"},"Budget"),i.a.createElement("div",{className:"budget-rhs"},c)),i.a.createElement(N,{onClick:function(t){return e.handleDirectionClick(t)}}),i.a.createElement(w,{handleOptionChange:this.handleOptionChange,selectedOption:this.state.pipe_size}),i.a.createElement("div",{className:"money-spent"},i.a.createElement("div",{className:"money-spent-lhs"},"Money Spent"),i.a.createElement("div",{className:"money-spent-rhs",style:{color:d}},o)),i.a.createElement("div",{className:"money-rem"},i.a.createElement("div",{className:"money-rem-lhs"},"Money Remaining"),i.a.createElement("div",{className:"money-rem-rhs",style:{color:d}},c-o)),i.a.createElement(S,{handlePressureChange:this.handlePressureChange}),i.a.createElement(O,{onClick:function(){return e.handleReset()}})),this.state.visible&&i.a.createElement("div",{style:{position:"absolute",top:this.state.menuY,left:this.state.menuX},className:"menu"},i.a.createElement("div",null,i.a.createElement("button",{onClick:this.handleDeletePipe,value:"del",className:"menu-buttons"},"Delete pipe")),i.a.createElement("div",null,i.a.createElement("button",{onClick:this.handleSizeChange,value:"large",className:"menu-buttons"},"Change to 1 inch")),i.a.createElement("div",null,i.a.createElement("button",{onClick:this.handleSizeChange,value:"medium",className:"menu-buttons"},"Change to 0.75 inch")),i.a.createElement("div",null,i.a.createElement("button",{onClick:this.handleSizeChange,value:"small",className:"menu-buttons"},"Change to 0.5 inch")))),i.a.createElement("div",{className:"links"},"Feeling Lost? Here's a ",i.a.createElement("a",{href:"https://phet.colorado.edu/sims/cheerpj/fluid-pressure-and-flow/latest/fluid-pressure-and-flow.html",target:"_blank"},"simulation")," and some ",i.a.createElement("a",{href:"/sim/tutorials",target:"_blank"}," tutorials"),".")):i.a.createElement(f,{handleLogin:this.handleLogin})}}]),a}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[10,1,2]]]);
//# sourceMappingURL=main.550c6200.chunk.js.map